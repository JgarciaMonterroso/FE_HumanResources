@inherits LayoutComponentBase
@using FE_HumanResources.Models
@inject ILocalStorageService LocalStorage
@inject NavigationManager NavigationManager

@if (userModel == null)
{
    <FE_HumanResources.Pages.Login />
}
else
{
    <RadzenLayout style="position: relative;" class="page">
        <RadzenHeader>
            <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="0">
                <RadzenSidebarToggle Click="@(() => sidebarExpanded = !sidebarExpanded)" />
                <img src="source/branding-institucional/logo-prodisa.png" alt="" width="32px">
                <RadzenLabel Text="Industrias Francelli RH" />
                <TopMenu />
            </RadzenStack>
        </RadzenHeader>
        <RadzenSidebar Responsive="false" @bind-Expanded="@sidebarExpanded" style="position: absolute">
            <div class="rz-p-4">
                <SideBar />
            </div>
        </RadzenSidebar>
        <RadzenFooter class="rz-text-align-center">
            Industrias Francelli Todos los Derechos Reservados 2024
        </RadzenFooter>
        <article class="content px-4">
            @Body
        </article>
    </RadzenLayout>

}

<RadzenComponents />
<RadzenContextMenu />
<RadzenNotification />
<RadzenDialog />
<RadzenTooltip />

@code {
    bool sidebarExpanded = false;
    private UserModel? userModel = new UserModel();
    protected override async Task OnInitializedAsync()
    {
        userModel = null;
        string? usr = await LocalStorage.GetItemAsync<string>("logedUser");

        if (!string.IsNullOrEmpty(usr))
        {
            userModel = JsonConvert.DeserializeObject<UserModel>(usr);
        }
    }
}